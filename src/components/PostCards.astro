---
const { post } = Astro.props;

if (!post || !post.data) {
  console.warn("‚ö†Ô∏è PostCard received invalid props:", Astro.props);
  throw new Error("PostCard requires a valid `post` object with `data`.");
}

console.log("üß© Rendering PostCard:", {
  slug: post.slug,
  title: post.data.title,
  pubDatetime: post.data.pubDatetime,
  description: post.data.description,
  cover: post.data.cover,
});

const date = new Date(post.data.pubDatetime);
const formattedDate = date.toLocaleDateString("en-US", {
  year: "numeric",
  month: "short",
  day: "numeric",
});
const formattedTime = date.toLocaleTimeString("en-US", {
  hour: "2-digit",
  minute: "2-digit",
});
---

<article
  class="md:flex-row group flex flex-col items-start gap-6 border-b border-gray-300 py-6 dark:border-gray-700"
>
  <!-- Left: Meta -->
  <div class="flex-1 space-y-2">
    <h2
      class="text-xl font-semibold tracking-tight text-gray-900 transition group-hover:text-indigo-600 dark:text-gray-100"
    >
      <a href={`/blog/${post.slug}`}>{post.data.title}</a>
    </h2>

    <p class="text-sm text-gray-500 dark:text-gray-400">
      Published: {formattedDate} | at {formattedTime}
    </p>

    <p class="text-base leading-relaxed text-gray-700 dark:text-gray-300">
      {post.data.description}
    </p>
  </div>

  <!-- Right: Image -->
  {
    post.data.cover ? (
      <div class="md:w-40 w-full shrink-0">
        <img
          src={post.data.cover}
          alt={post.data.title}
          class="aspect-video rounded-md object-cover shadow-sm"
          loading="lazy"
        />
      </div>
    ) : (
      <div class="md:w-40 flex w-full shrink-0 items-center justify-center text-xs italic text-gray-400">
        No image provided
      </div>
    )
  }
</article>
